figuring out good order of branching and re-mergin branches.